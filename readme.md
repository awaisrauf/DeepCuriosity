Taken from https://github.com/KingFelix/emerald. 
